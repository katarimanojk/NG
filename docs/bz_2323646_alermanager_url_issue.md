
Two out of three alertmanagers are configured with wrong URLs

root@controller1.rent-dc1 /var/log# cat /var/lib/ceph/7b3153f8-de15-11e9-83de-e4434b135035/alertmanager.controller1/etc/alertmanager/alertmanager.yml
# This file is generated by cephadm.
# See https://prometheus.io/docs/alerting/configuration/ for documentation.

global:
  resolve_timeout: 5m
  http_config:
    tls_config:
      insecure_skip_verify: true

route:
  receiver: 'default'
  routes:
    - group_by: ['alertname']
      group_wait: 10s
      group_interval: 10s
      repeat_interval: 1h
      receiver: 'ceph-dashboard'

receivers:
- name: 'default'
  webhook_configs:
- name: 'ceph-dashboard'
  webhook_configs:
  - url: 'http://controller1.storage.rent-dc1.otenet.gr:8444/api/prometheus_receiver'
  - url: 'http://controller2.ctlplane.rent-dc1.otenet.gr:8444/api/prometheus_receiver'
  - url: 'http://controller3.ctlplane.rent-dc1.otenet.gr:8444/api/prometheus_receiver'



in ceph-ansible, alermanager.yml is generated here

https://github.com/ceph/ceph-ansible/blob/main/roles/ceph-prometheus/tasks/main.yml#L51
https://github.com/ceph/ceph-ansible/blob/main/roles/ceph-prometheus/templates/alertmanager.yml.j2#L14



which should be set to mgr/cephadm/services/alertmanager/alertmanager.yml

